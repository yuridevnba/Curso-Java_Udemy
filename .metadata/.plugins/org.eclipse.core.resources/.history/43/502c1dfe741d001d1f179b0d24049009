package model.services;

import model.entities.CarRental;
import model.entities.Invoice;

public class RentalService {
private Double pricePerDay;
private Double pricePerHour;

private BrazilTaxService brazil;

public RentalService(Double pricePerDay, Double pricePerHour, BrazilTaxService brazil) {
	super();
	this.pricePerDay = pricePerDay;
	this.pricePerHour = pricePerHour;
	this.brazil = brazil;
}

public void processInvoice(CarRental carRental) {
	long t1 = carRental.getStart().getTime();
	long t2= carRental.getFinish().getTime();
	
	double basicPayment;
	double hours = (double)(t2-t1)/1000/60/60; // segundos, minutos, horas.
	if(hours<=12.0) {
		 basicPayment=Math.ceil(hours)*pricePerHour;
	}
	else {
		basicPayment= Math.ceil(hours/24)*pricePerDay;
	}
	double tax = brazil.tax(basicPayment);
	
	carRental.setInvoice(new Invoice(basicPayment,tax)); // um novo objeto de nota de pagamento, associando com o aluguel.
}
}
